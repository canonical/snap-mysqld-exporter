name: mysqld-exporter
base: core22
adopt-info: mysqld-exporter
summary: The mysqld prometheus exporter from the Prometheus community
description: |
  Provides the mysqld prometheus exporter from the Prometheus community as
  a snap for collecting metrics from a mysql server instance.

grade: devel
confinement: strict
architectures:
  - build-on: amd64
  - build-on: arm64
  - build-on: ppc64el
  - build-on: s390x
apps:
  mysqld-exporter:
    command: 'bin/mysqld-exporter-service'
    daemon: simple
    plugs:
      - network
      - network-bind

parts:
  mysqld-exporter:
    plugin: go
    build-snaps:
      - go
    source-type: git
    source: https://github.com/prometheus/mysqld_exporter.git
    source-tag: "v0.14.0"
    override-pull: |
      snapcraftctl pull
      snapcraftctl set-version "$(git describe)"

  snap-hooks:
    source: .
    plugin: python

  templates:
    source: templates/
    plugin: dump
    organize:
      '*': templates/
